/* Meiya 2016-05-26 10:47 */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d={elem:".J_Loading",onshow:function(){},onhide:function(){}},e='<div class="J_Loading loading"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>',f=function(a){var b=null;a=$.extend(d,a||{}),$.extend(this,a),b=$(a.elem),0===b.length&&(b=$(e),document.body.appendChild(b[0])),this.$elem=b},g=f.prototype={constructor:f};$.extend(g,{show:function(){return this.$elem.show(),this.__dispatchEvent("show"),this},hide:function(){return this.$elem.hide(),this.__dispatchEvent("hide"),this},__dispatchEvent:function(a,b){this["on"+a]&&this["on"+a](b)},destory:function(){this.$elem.remove();for(var a in this)delete this[a];return this}}),b.exports=f},{}],2:[function(a,b,c){"use strict";function d(a){window.WebViewJavascriptBridge?a(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){a(WebViewJavascriptBridge)},!1)}function e(a,b,c){switch(a){case"share_channel_action":if(f.system.iPhone&&g.Version(f.app.ver,"2.3.0")<=0){var d=b.weibo;"object"==typeof d&&(d.title=d.title+d.url,d.content=d.content+d.url)}break;case"get_query_string":if("function"==typeof c){var e=location.search.replace(/^\?/,""),h=location.hash.replace(/^\#/,""),i=e+(e?"#":"")+h;f.system.iPhone&&-1===g.Version(f.app.ver,"2.7.0")?c({query_string:i}):f.system.Android&&-1===g.Version(f.app.ver,"2.3.0")&&c({query_string:i})}}}var f=a("./ua"),g=window.MY=window.MY||{},h={defaultHandler:function(a,b){b("got")},send:function(a,b){d(function(c){c.send(a,function(a){"function"==typeof b&&b(a)})})},callHandler:function(a,b,c){"function"==typeof b&&(c=b,b=null),e.call(null,a,b,c),d(function(d){d.callHandler(a,b,function(a){"function"==typeof c&&c(a)})})},registerHandler:function(a,b){d(function(c){c.registerHandler(a,function(a){"function"==typeof b&&b(a)})})}};d(function(a){a.init&&a.init&&a.init(h.defaultHandler)}),h.connectWebViewJavascriptBridge=d,g.appBridge=h,b.exports=h},{"./ua":4}],3:[function(a,b,c){"use strict";var d=a("./app-bridge"),e=function(){return this};e.prototype={constructor:e,onerror:function(a){var b=a.target.src;this.dataset.ip||e.queryIP(b).done(function(a,b){this.dataset.ip=a,this.src=this.src.replace(b,a)}.bind(this))}},e.queryIP=function(a){var b=$.Deferred(),c=/^https?:\/\/([^:\/\?#]+)/,e=a.match(c);if(e&&e.length){var f=e[1];d.callHandler("query_ip",{host:f},function(a){b.resolve(a.ip,f)})}return b.promise()},b.exports=new e},{"./app-bridge":2}],4:[function(a,b,c){"use strict";var d={ie:0,gecko:0,webkit:0,khtml:0,opera:0,ver:""},e={ie:0,firefox:0,safari:0,konq:0,opera:0,chrome:0,ver:""},f={win:!1,mac:!1,x11:!1,iPhone:!1,iPad:!1,iOS:!1,Android:!1,winPhone:!1},g=!1,h=navigator.userAgent,i=navigator.platform;if(/(Meiya(?:-dev)?)/.test(h)){var j=RegExp.$1;g={name:j,ver:/Meiya(?:-dev)?\/(\d+\.\d+\.\d+(?:\.\d+)?)\D/.exec(h)[1],isDev:/Meiya-dev/.test(j)}}if(f.win=0==i.indexOf("Win"),f.mac=0==i.indexOf("Mac"),f.x11=0==i.indexOf("X11")||0==i.indexOf("Linux"),f.win&&/Win(?:dows )?([^do]{2})\s?(\d+\.\d+)?/.test(h))if("NT"==RegExp.$1)switch(RegExp.$2){case"5.0":f.win="2000";break;case"5.1":f.win="XP";break;case"6.0":f.win="Vista";break;case"6.1":f.win="7";break;default:f.win="NT"}else"9x"==RegExp.$1?f.win="ME":f.win=RegExp.$1;if(f.iPhone=h.indexOf("iPhone")>-1,f.iPad=h.indexOf("iPad")>-1,f.mac&&h.indexOf("Mobile")>-1&&(/CPU (?:iPhone )?OS (\d+_\d+)/.test(h)?f.iOS=parseFloat(RegExp.$1.replace("_",".")):f.iOS=2),/Android (\d+\.\d+)/.test(h)&&(f.Android=parseFloat(RegExp.$1)),"CE"==f.win?f.winPhone=f.win:"Ph"==f.win&&/Windows Phone OS (\d+\.\d+)/.test(h)&&(f.win="Phone",f.winPhone=parseFloat(RegExp.$1)),window.opera)d.ver=e.ver=window.opera.version(),d.opera=e.opera=parseFloat(d.ver);else if(/AppleWebKit\/(\S+)/.test(h))if(d.ver=RegExp.$1,d.webkit=parseFloat(d.ver),/Chrome\/(\S+)/.test(h))e.ver=RegExp.$1,e.chrome=parseFloat(e.ver);else if(/Version\/(\S+)/.test(h))e.ver=RegExp.$1,e.safari=parseFloat(e.ver);else{var k=1;k=d.webkit<100?1:d.webkit<312?1.2:d.webkit<412?1.3:2,e.safari=e.ver=k}else/KHTML\/(\S+)/.test(h)||/Konqueror\/([^;]+)/.test(h)?(d.ver=e.ver=RegExp.$1,d.khtml=e.konq=parseFloat(d.ver)):/rv:([^\)]+)\) Gecko\/\d{8}/.test(h)?(d.ver=RegExp.$1,d.gecko=parseFloat(d.ver),/Firefox\/(\S+)/.test(h)&&(e.ver=RegExp.$1,e.firefox=parseFloat(e.ver))):/MISE ([^;]+)/.test(h)&&(d.ver=e.ver=RegExp.$1,d.ie=e.ie=parseFloat(d.ver));b.exports={engine:d,browser:e,system:f,app:g}},{}],5:[function(a,b,c){"use strict";var d=(a("./app-bridge"),a("./images")),e=$(window),f={elements:null,threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"},g=function(a,b){var c=this;"object"==typeof a&&(b=a,a=b.elements);var g=this.$elements=$(a);b=$.extend(f,b),b.elements||(b.elements=a),this.options=b;var h=this.$container=void 0===b.container||b.container===window?e:$(b.container);return 0===b.event.indexOf("scroll")&&h.on(b.event,function(){c.update()}),g.each(function(){var a=this,e=$(a);a.loaded=!1,(void 0===e.attr("src")||e.attr("src")===!1)&&e.is("img")&&e.attr("src",b.placeholder),e.one("appear",function(){if(!this.loaded){if(b.appear){var f=g.length;b.appear.call(a,f,b)}$("<img />").on("error",d.onerror).on("load",function(){var d=e.attr("data-"+b.data_attribute);e.hide(),e.is("img")?e.attr("src",d):e.css("background-image","url('"+d+"')"),e[b.effect](b.effect_speed),a.loaded=!0;var f=$.grep(g,function(a){return!a.loaded});if(g=c.$element=$(f),b.load){var h=g.length;b.load.call(a,h,b)}}).attr("src",e.attr("data-"+b.data_attribute))}}),0!==b.event.indexOf("scroll")&&e.on(b.event,function(){a.loaded||e.trigger("appear")})}),e.on("resize",function(){c.update()}),$(document).ready(function(){c.update()}),this};g.prototype={constructor:g,visible:function(a){return a=$(a),!(!a.width()&&!a.height())&&"none"!==a.css("display")},update:function(){var a=this,b=0,c=this.$elements,d=this.options;c.each(function(){var c=$(this);if(!d.skip_invisible||a.visible(this))if(a.abovethetop(this,d)||a.leftofbegin(this,d));else if(a.belowthefold(this,d)||a.rightoffold(this,d)){if(++b>d.failure_limit)return!1}else c.trigger("appear"),b=0})},abovethetop:function(a,b){var c;return c=void 0===b.container||b.container===window?e.scrollTop():$(b.container).offset().top,c>=$(a).offset().top+b.threshold+$(a).height()},leftofbegin:function(a,b){var c;return c=void 0===b.container||b.container===window?e.scrollLeft():$(b.container).offset().left,c>=$(a).offset().left+b.threshold+$(a).width()},belowthefold:function(a,b){var c;return c=void 0===b.container||b.container===window?(window.innerHeight?window.innerHeight:e.height())+e.scrollTop():$(b.container).offset().top+$(b.container).height(),c<=$(a).offset().top-b.threshold},rightoffold:function(a,b){var c;return c=void 0===b.container||b.container===window?e.width()+e.scrollLeft():$(b.container).offset().left+$(b.container).width(),c<=$(a).offset().left-b.threshold}},b.exports=g},{"./app-bridge":2,"./images":3}],6:[function(a,b,c){"use strict";var d=a("./tpl/template"),e=a("../../public/src/utils/zepto.lazyload"),f=a("../../public/src/ui/zepto.loading"),g=new f,h=MY.appBridge,i={};i.list={url:"/api/trials",data:[],$container:$("#J_Content"),_xhr:function(){return MY.xhr.get(this.url).done(function(a){this.data=a.data}.bind(this))},render:function(){var a=d("list",{data:this.data,now:(new Date).getTime(),dateFormat:function(a,b){a=new Date(a);var c={M:a.getMonth()+1,d:a.getDate(),h:a.getHours(),m:a.getMinutes(),s:a.getSeconds(),q:Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};return b=b.replace(/([yMdhmsqS])+/g,function(b,d){var e=c[d];return void 0!==e?(b.length>1&&(e="0"+e,e=e.substr(e.length-2)),e):"y"===d?(a.getFullYear()+"").substr(4-b.length):b})},timeFormat:function(a){var b=new Date(a),c=new Date,d=Math.round((b.getTime()-c.getTime())/1e3),e=function(a){return a>0?(9>=a&&(a="0"+a),String(a)):"00"},f={s:"00",m:"00",h:"00",d:"00",M:"00",y:"0"};d>0&&(f.s=e(d%60),f.m=Math.floor(d/60)>0?e(Math.floor(d/60)%60):"00",f.h=Math.floor(d/3600)>0?e(Math.floor(d/3600)%24):"00",f.d=Math.floor(d/86400)>0?e(Math.floor(d/86400)):"00",f.M=Math.floor(d/2629744)>0?e(Math.floor(d/2629744)%12):"00",f.y=Math.floor(d/31556926)>0?Math.floor(d/31556926):"0");var g="";return g="00"!=f.d?f.d+"天"+f.h+"小时":f.h+"小时"+f.m+"分"}});this.$container.html(a),this.handler()},handler:function(){this.$container.find(".J_Link").on("tap",function(){var a=this.dataset.id;h.callHandler("navi_page_action","meiya://trials/"+a,function(){})}),new e(".J_Link img")},init:function(){return this._xhr().done(this.render.bind(this))}},i.init=function(){this.list.init().done(function(){g.hide().destory()})},i.init()},{"../../public/src/ui/zepto.loading":1,"../../public/src/utils/zepto.lazyload":5,"./tpl/template":7}],7:[function(a,b,c){"use strict";!function(){function a(a,b){return(/string|function/.test(typeof b)?j:i)(a,b)}function d(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?d(a.call(a)):""),a}function e(a){return n[a]}function f(a){return d(a).replace(/&(?![\w#]+;)|[<>"']/g,e)}function g(a,b){if(o(a))for(var c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)}function h(a,b){var c=/(\/)[^\/]+\1\.\.\1/,d=("./"+a).replace(/[^\/]+$/,""),e=d+b;for(e=e.replace(/\/\.\//g,"/");e.match(c);)e=e.replace(c,"/");return e}function i(b,c){var d=a.get(b)||k({filename:b,name:"Render Error",message:"Template not found"});return c?d(c):d}function j(a,b){if("string"==typeof b){var c=b;b=function(){return new m(c)}}var d=l[a]=function(c){try{return new b(c,a)+""}catch(d){return k(d)()}};return d.prototype=b.prototype=p,d.toString=function(){return b+""},d}function k(a){var b="{Template Error}",c=a.stack||"";if(c)c=c.split("\n").slice(0,2).join("\n");else for(var d in a)c+="<"+d+">\n"+a[d]+"\n\n";return function(){return"object"==typeof console&&console.error(b+"\n\n"+c),b}}var l=a.cache={},m=window.String,n={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},o=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},p=a.utils={$helpers:{},$include:function(a,b,c){return a=h(c,a),i(a,b)},$string:d,$escape:f,$each:g},q=a.helpers=p.$helpers;a.get=function(a){return l[a.replace(/^\.\//,"")]},a.helper=function(a,b){q[a]=b},"function"==typeof define?define(function(){return a}):"undefined"!=typeof c?b.exports=a:this.template=a,a("list",function(a){var b=this,c=(b.$helpers,b.$each),d=a.data,e=(a.$value,a.$index,b.$escape),f=(a.image,a.index,a.now),g=a.dateFormat,h=a.timeFormat,i="";return i+=" ",c(d,function(a){i+=' <div class="test-item"> <div class="test-pic"> <a class="J_Link" href="javascript:;" data-id="',i+=e(a.id),i+='"> <img src="./img/lazy-bg.png" ',c(a.images,function(a){i+=" ",2==a.priority&&(i+=' data-original="',i+=e(a.url),i+='?imageView2/2/w/640" '),i+=" "}),i+=' > </a> </div> <div class="test-info"> ',f<1e3*a.start_time&&(i+=' <div class="label yellow"> 未开始 </div><div class="time"> <span class="label">开始时间</span> <span class="inner">',i+=e(g(1e3*a.start_time,"MM-dd hh:mm")),i+="</span> </div> "),i+=" ",f>1e3*a.start_time&&f<1e3*a.end_time&&(i+=' <div class="label red"> 火热进行 </div><div class="time"> <span class="label">剩余时间</span> <span class="inner">',i+=e(h(1e3*a.end_time)),i+="</span> </div> "),i+=" ",f>1e3*a.end_time&&(i+=' <div class="label"> 已结束 </div> '),i+=' <div class="follow"> <span class="label">热度</span> <span class="num">',i+=e(a.heat),i+="</span> </div> </div> </div> "}),new m(i)})}()},{}]},{},[6]);