/* Meiya 2016-05-26 10:47 */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d={elem:".J_Loading",onshow:function(){},onhide:function(){}},e='<div class="J_Loading loading"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>',f=function(a){var b=null;a=$.extend(d,a||{}),$.extend(this,a),b=$(a.elem),0===b.length&&(b=$(e),document.body.appendChild(b[0])),this.$elem=b},g=f.prototype={constructor:f};$.extend(g,{show:function(){return this.$elem.show(),this.__dispatchEvent("show"),this},hide:function(){return this.$elem.hide(),this.__dispatchEvent("hide"),this},__dispatchEvent:function(a,b){this["on"+a]&&this["on"+a](b)},destory:function(){this.$elem.remove();for(var a in this)delete this[a];return this}}),b.exports=f},{}],2:[function(a,b,c){"use strict";!function(){function a(a,b){return(/string|function/.test(typeof b)?j:i)(a,b)}function d(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?d(a.call(a)):""),a}function e(a){return n[a]}function f(a){return d(a).replace(/&(?![\w#]+;)|[<>"']/g,e)}function g(a,b){if(o(a))for(var c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)}function h(a,b){var c=/(\/)[^\/]+\1\.\.\1/,d=("./"+a).replace(/[^\/]+$/,""),e=d+b;for(e=e.replace(/\/\.\//g,"/");e.match(c);)e=e.replace(c,"/");return e}function i(b,c){var d=a.get(b)||k({filename:b,name:"Render Error",message:"Template not found"});return c?d(c):d}function j(a,b){if("string"==typeof b){var c=b;b=function(){return new m(c)}}var d=l[a]=function(c){try{return new b(c,a)+""}catch(d){return k(d)()}};return d.prototype=b.prototype=p,d.toString=function(){return b+""},d}function k(a){var b="{Template Error}",c=a.stack||"";if(c)c=c.split("\n").slice(0,2).join("\n");else for(var d in a)c+="<"+d+">\n"+a[d]+"\n\n";return function(){return"object"==typeof console&&console.error(b+"\n\n"+c),b}}var l=a.cache={},m=window.String,n={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},o=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},p=a.utils={$helpers:{},$include:function(a,b,c){return a=h(c,a),i(a,b)},$string:d,$escape:f,$each:g},q=a.helpers=p.$helpers;a.get=function(a){return l[a.replace(/^\.\//,"")]},a.helper=function(a,b){q[a]=b},"function"==typeof define?define(function(){return a}):"undefined"!=typeof c?b.exports=a:this.template=a,a("tip",function(a){var b=this,c=(b.$helpers,b.$escape),d=a.data,e="";return e+='<div id="tip" class="tip"> <span>',e+=c(d),e+="</span> </div>",new m(e)}),a("userlist",function(a){var b=this,c=(b.$helpers,b.$each),d=a.lists,e=(a.$value,a.$index,b.$escape),f="";return c(d,function(a){f+=' <a data-url="meiya://users/',f+=e(a.id),f+='"> <div class="avatar"> ',a.avatar_url?(f+=' <img src="',f+=e(a.avatar_url),f+='?imageView2/1/w/160" alt=""> '):f+=' <img src="http://st0.meiyaapp.com/app/default_avatar.jpg" alt=""> ',f+=' </div> <div class="infos"> <div class="author"> <span class="username">',f+=e(a.username),f+="</span> ",a.talent&&(f+=' <span class="icon icon-talent"></span> '),f+=' </div> <div class="tools"> <span class="view">关注 <span>',f+=e(a.star_count),f+='</span></span> <span class="comment">粉丝 <span>',f+=e(a.fan_count),f+="</span></span> </div> </div> </a> "}),new m(f)})}()},{}],3:[function(a,b,c){"use strict";var d=a("./tpl/users"),e=a("../../public/src/ui/zepto.loading"),f=MY.appBridge,g=new e,h=$("#J_UserLists"),i=($(".users"),{page:1,loading:!1,search:"",init:function(){var a=this;f.callHandler("get_query_string",function(b){/search=(\S+)/.exec(b.query_string);a.search=decodeURI(RegExp.$1),a.getData(this.page),a.event(),a.setScroll()})},getData:function(a){MY.xhr.get("/api/search",{q:this.search,page:a,per_page:30,type:"User"}).done(function(a){i.setData(a.data),g.hide()})},setData:function(a){if(a.length){var b={lists:a};h.append(d("userlist",b)),i.loading=!1}else f.callHandler("my_toast",{delay:1,content:"没有更多内容啦~"})},event:function(){h.delegate("a","tap",function(a){a.preventDefault();var b=$(this),c=b.attr("data-url");f.callHandler("navi_page_action",c)})},setScroll:function(){$(window).scroll(function(a){var b=$(window).scrollTop(),c=$(document).height(),d=$(window).height();200>c-b-d&&!i.loading&&(i.page+=1,i.loading=!0,i.getData(i.page))})}});i.init()},{"../../public/src/ui/zepto.loading":1,"./tpl/users":2}]},{},[3]);