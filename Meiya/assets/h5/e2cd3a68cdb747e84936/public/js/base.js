/* Meiya 2016-05-26 10:47 */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=window.MY=window.MY||{},e=a("./utils/ua"),f=a("./utils/images"),g=a("./ui/zepto.toast"),h=a("./utils/version");document.addEventListener("error",function(a){"IMG"===a.target.tagName&&f.onerror.call(a.target,a)},!0);var i=d.isApp=e.app,j=d.isDevApp=e.app&&e.app.isDev,k=(d.isAndroid=e.system.Android,d.isiPhone=e.system.iPhone,location.origin),l=location.host;i&&(k="http://www.meiyaapp."+(j?"cn":"com"),l=k.replace(/^https?:\/\//,""),d.version=e.app.ver),d.locationOrigin=k,d.locationHost=l,d.Version=h;var m=a("./utils/app-bridge"),n=(a("./utils/zepto.xhr"),a("./utils/dateformat"));d.dateFormat=n,m.registerHandler("call_share_channel_action",function(){m.callHandler("share_channel_action",{default_share:{title:document.title,content:document.title,url:location.href,image_url:"http://st0.meiyaapp.com/act/public/img/logo-80X80.png"},weibo:{title:document.title,content:document.title,url:location.href,image_url:"http://st0.meiyaapp.com/act/public/img/logo-80X80.png"}})}),setTimeout(function(){if(!navigator.onLine){new g({delay:1,content:"网络错误"}).show()}},50),b.exports=d},{"./ui/zepto.toast":2,"./utils/app-bridge":3,"./utils/dateformat":4,"./utils/images":5,"./utils/ua":6,"./utils/version":7,"./utils/zepto.xhr":8}],2:[function(a,b,c){"use strict";function d(a,b){for(var c in b)a=a.replace(new RegExp("\\{"+c+"\\}","g"),b[c]);return a}var e={delay:0,loading:!1,content:"",fixed:!0,mask:!0,duration:.5,align:"center",onshow:function(){},onclose:function(){}},f='<div class="my-toast">{loading}<div class="inner">{content}</div></div>',g='<div class="loading"></div>',h=function j(a){a=$.extend({},e,a||{}),$.extend(this,a);var b=d(f,{content:this.content,loading:this.loading?g:""}),c=this.zIndex||j.zIndex,h=this.$elem=$(b).css({display:"none",position:"absolute",boxSizing:"border-box",minWidth:"6.25rem",padding:"1rem",borderRadius:".625rem",backgroundColor:"rgba(0, 0, 0, .75)",fontSize:"1rem",color:"white",zIndex:c,opacity:0,textAlign:this.align,transition:"opacity "+this.duration+"s ease-out"}).attr("tabindex","-1").appendTo("body");this.$mask=$("<div />").css({display:"none",position:"fixed",left:0,top:0,bottom:0,right:0,width:"100%",height:"100%",userSelect:"none",zIndex:c-1,backgroundColor:"rgba(0, 0, 0, 0)"}).insertAfter(h[0]),this.$content=h.find(".inner")},i=h.prototype={constructor:h};$.extend(i,{show:function(){var a=this,b=this.$elem;b.css("position",this.fixed?"fixed":"absolute"),this.mask&&this.$mask.show(),b.show().css({opacity:1}),this.reset(),this.__dispatchEvent("show");var c=this.delay;return c&&"number"==typeof c&&setTimeout(function(){a.close().remove()},1e3*c),this},close:function(){return this.$elem.hide(),this.$mask.hide(),this},remove:function(){this.$elem.remove(),this.$mask.remove();for(var a in this)delete this[a];return this},reset:function(){var a=this.$elem,b=$(window),c=this.fixed,d=c?0:b.scrollLeft(),e=c?0:b.scrollTop(),f=b.width(),g=b.height(),h=a.width(),i=a.height(),j=(f-h)/2+d,k=382*(g-i)/1e3+e,l=a[0].style;return l.left=Math.max(parseInt(j),d)+"px",l.top=Math.max(parseInt(k),e)+"px",this},__dispatchEvent:function(a,b){this["on"+a]&&this["on"+a](b)}}),h.zIndex=99,b.exports=h},{}],3:[function(a,b,c){"use strict";function d(a){window.WebViewJavascriptBridge?a(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){a(WebViewJavascriptBridge)},!1)}function e(a,b,c){switch(a){case"share_channel_action":if(f.system.iPhone&&g.Version(f.app.ver,"2.3.0")<=0){var d=b.weibo;"object"==typeof d&&(d.title=d.title+d.url,d.content=d.content+d.url)}break;case"get_query_string":if("function"==typeof c){var e=location.search.replace(/^\?/,""),h=location.hash.replace(/^\#/,""),i=e+(e?"#":"")+h;f.system.iPhone&&-1===g.Version(f.app.ver,"2.7.0")?c({query_string:i}):f.system.Android&&-1===g.Version(f.app.ver,"2.3.0")&&c({query_string:i})}}}var f=a("./ua"),g=window.MY=window.MY||{},h={defaultHandler:function(a,b){b("got")},send:function(a,b){d(function(c){c.send(a,function(a){"function"==typeof b&&b(a)})})},callHandler:function(a,b,c){"function"==typeof b&&(c=b,b=null),e.call(null,a,b,c),d(function(d){d.callHandler(a,b,function(a){"function"==typeof c&&c(a)})})},registerHandler:function(a,b){d(function(c){c.registerHandler(a,function(a){"function"==typeof b&&b(a)})})}};d(function(a){a.init&&a.init&&a.init(h.defaultHandler)}),h.connectWebViewJavascriptBridge=d,g.appBridge=h,b.exports=h},{"./ua":6}],4:[function(a,b,c){"use strict";b.exports=function(a,b){a=new Date(a);var c={M:a.getMonth()+1,d:a.getDate(),h:a.getHours(),m:a.getMinutes(),s:a.getSeconds(),q:Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};return b=b.replace(/([yMdhmsqS])+/g,function(b,d){var e=c[d];return void 0!==e?(b.length>1&&(e="0"+e,e=e.substr(e.length-2)),e):"y"===d?(a.getFullYear()+"").substr(4-b.length):b})}},{}],5:[function(a,b,c){"use strict";var d=a("./app-bridge"),e=function(){return this};e.prototype={constructor:e,onerror:function(a){var b=a.target.src;this.dataset.ip||e.queryIP(b).done(function(a,b){this.dataset.ip=a,this.src=this.src.replace(b,a)}.bind(this))}},e.queryIP=function(a){var b=$.Deferred(),c=/^https?:\/\/([^:\/\?#]+)/,e=a.match(c);if(e&&e.length){var f=e[1];d.callHandler("query_ip",{host:f},function(a){b.resolve(a.ip,f)})}return b.promise()},b.exports=new e},{"./app-bridge":3}],6:[function(a,b,c){"use strict";var d={ie:0,gecko:0,webkit:0,khtml:0,opera:0,ver:""},e={ie:0,firefox:0,safari:0,konq:0,opera:0,chrome:0,ver:""},f={win:!1,mac:!1,x11:!1,iPhone:!1,iPad:!1,iOS:!1,Android:!1,winPhone:!1},g=!1,h=navigator.userAgent,i=navigator.platform;if(/(Meiya(?:-dev)?)/.test(h)){var j=RegExp.$1;g={name:j,ver:/Meiya(?:-dev)?\/(\d+\.\d+\.\d+(?:\.\d+)?)\D/.exec(h)[1],isDev:/Meiya-dev/.test(j)}}if(f.win=0==i.indexOf("Win"),f.mac=0==i.indexOf("Mac"),f.x11=0==i.indexOf("X11")||0==i.indexOf("Linux"),f.win&&/Win(?:dows )?([^do]{2})\s?(\d+\.\d+)?/.test(h))if("NT"==RegExp.$1)switch(RegExp.$2){case"5.0":f.win="2000";break;case"5.1":f.win="XP";break;case"6.0":f.win="Vista";break;case"6.1":f.win="7";break;default:f.win="NT"}else"9x"==RegExp.$1?f.win="ME":f.win=RegExp.$1;if(f.iPhone=h.indexOf("iPhone")>-1,f.iPad=h.indexOf("iPad")>-1,f.mac&&h.indexOf("Mobile")>-1&&(/CPU (?:iPhone )?OS (\d+_\d+)/.test(h)?f.iOS=parseFloat(RegExp.$1.replace("_",".")):f.iOS=2),/Android (\d+\.\d+)/.test(h)&&(f.Android=parseFloat(RegExp.$1)),"CE"==f.win?f.winPhone=f.win:"Ph"==f.win&&/Windows Phone OS (\d+\.\d+)/.test(h)&&(f.win="Phone",f.winPhone=parseFloat(RegExp.$1)),window.opera)d.ver=e.ver=window.opera.version(),d.opera=e.opera=parseFloat(d.ver);else if(/AppleWebKit\/(\S+)/.test(h))if(d.ver=RegExp.$1,d.webkit=parseFloat(d.ver),/Chrome\/(\S+)/.test(h))e.ver=RegExp.$1,e.chrome=parseFloat(e.ver);else if(/Version\/(\S+)/.test(h))e.ver=RegExp.$1,e.safari=parseFloat(e.ver);else{var k=1;k=d.webkit<100?1:d.webkit<312?1.2:d.webkit<412?1.3:2,e.safari=e.ver=k}else/KHTML\/(\S+)/.test(h)||/Konqueror\/([^;]+)/.test(h)?(d.ver=e.ver=RegExp.$1,d.khtml=e.konq=parseFloat(d.ver)):/rv:([^\)]+)\) Gecko\/\d{8}/.test(h)?(d.ver=RegExp.$1,d.gecko=parseFloat(d.ver),/Firefox\/(\S+)/.test(h)&&(e.ver=RegExp.$1,e.firefox=parseFloat(e.ver))):/MISE ([^;]+)/.test(h)&&(d.ver=e.ver=RegExp.$1,d.ie=e.ie=parseFloat(d.ver));b.exports={engine:d,browser:e,system:f,app:g}},{}],7:[function(a,b,c){"use strict";b.exports=function(a,b){if(!a)return-1;if(a=String(a),b=String(b),a===b)return 0;for(var c=a.split("."),d=b.split("."),e=Math.max(c.length,d.length),f=0;e>f;f++){if(c[f]="undefined"==typeof c[f]?0:parseInt(c[f],10),d[f]="undefined"==typeof d[f]?0:parseInt(d[f],10),c[f]>d[f])return 1;if(c[f]<d[f])return-1}return 0}},{}],8:[function(a,b,c){"use strict";function d(a){return k||!/meiyaapp/.test(j.locationHost)?[a,".meiyaapp.",m].join(""):location.host}function e(a){return"string"!=typeof a||/^https?:\/\//.test(a)?!1:!0}function f(a,b){var c="";return e(a)&&(c=d(b?"api":"www"),a=["http://",c,a].join("")),a}function g(){var a=$.Deferred();return h.callHandler("get_api_header",function(b){a.resolve(b)}),a.promise()}var h=a("./app-bridge"),i=a("./ua"),j=window.MY=window.MY||{},k=i.app,l={},m=k&&!i.app.isDev?"com":"cn";l.ajax=function(a){var b=$.Deferred(),c=a.url;a.dataType=a.dataType||"json",a.url=f(c,a.data&&a.data.signature);var d=$.ajax(a);return d.done(function(){b.resolve.apply(this,arguments)}).fail(function(a){b.reject.apply(this,arguments)}),b.promise()},l.api=function(a){var b=$.Deferred(),c=this;if(i.app)a.data=$.extend({},{os:i.system.iPhone?"ios":"android",version:i.app.ver},a.data||{}),g().done(function(d){h.callHandler("get_api_signature",{header:d,params:a.data},function(e){a.headers=$.extend({},d),a.data=$.extend(a.data,e);c.ajax(a).done(function(a){b.resolve.apply(this,arguments)}).fail(function(a){b.reject.apply(this,arguments)})})});else{a.data=$.extend(a.data||{},{signature:"123456"});this.ajax(a).done(function(a){b.resolve.apply(this,arguments)}).fail(function(){b.reject.apply(this,arguments)})}return b.promise()},String("get, post, put, delete").replace(/\w+/g,function(a){l[a]=function(b,c,d,e){$.isFunction(c)&&(e=d,d=c,c=void 0);var f={url:b,type:a,data:c,dataType:e,success:d},g=this.ajax(f);return g}}),j.xhr=l,b.exports=l},{"./app-bridge":3,"./ua":6}]},{},[1]);